// *** WARNING: this file was generated by the Pulumi Terraform Bridge (tfgen) Tool. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

package secure

import (
	"context"
	"reflect"

	"github.com/pkg/errors"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// ## Import
//
// Secure Falco runtime rules can be imported using the ID, e.g.
//
// ```sh
//  $ pulumi import sysdig:Secure/ruleFalco:RuleFalco example 12345
// ```
type RuleFalco struct {
	pulumi.CustomResourceState

	// This indicates that the rule being created appends the condition to an existing Sysdig-provided rule. By default this is false. Appending to user-created rules is not supported by the API.
	Append pulumi.BoolPtrOutput `pulumi:"append"`
	// A [Falco condition](https://falco.org/docs/rules/) is simply a Boolean predicate on Sysdig events expressed using the Sysdig [filter syntax](http://www.sysdig.org/wiki/sysdig-user-guide/#filtering) and macro terms.
	Condition pulumi.StringOutput `pulumi:"condition"`
	// The description of Secure rule. By default is empty.
	Description pulumi.StringPtrOutput `pulumi:"description"`
	// The exceptions key is a list of identifier plus list of tuples of filtercheck fields. See below for details.
	Exceptions RuleFalcoExceptionArrayOutput `pulumi:"exceptions"`
	// The name of the exception. Only used to provide a handy name, and to potentially link together values in a later rule that has `append = true`.
	Name pulumi.StringOutput `pulumi:"name"`
	// Add additional information to each Falco notification's output. Required if append is false.
	Output pulumi.StringPtrOutput `pulumi:"output"`
	// The priority of the Falco rule. It can be: "emergency", "alert", "critical", "error", "warning", "notice", "info" or "debug". By default is "warning".
	Priority pulumi.StringPtrOutput `pulumi:"priority"`
	// The source of the event. It can be either "syscall", "k8sAudit" or "awsCloudtrail". Required if append is false.
	Source pulumi.StringPtrOutput `pulumi:"source"`
	// A list of tags for this rule.
	Tags pulumi.StringArrayOutput `pulumi:"tags"`
	// Current version of the resource in Sysdig Secure.
	Version pulumi.IntOutput `pulumi:"version"`
}

// NewRuleFalco registers a new resource with the given unique name, arguments, and options.
func NewRuleFalco(ctx *pulumi.Context,
	name string, args *RuleFalcoArgs, opts ...pulumi.ResourceOption) (*RuleFalco, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.Condition == nil {
		return nil, errors.New("invalid value for required argument 'Condition'")
	}
	var resource RuleFalco
	err := ctx.RegisterResource("sysdig:Secure/ruleFalco:RuleFalco", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetRuleFalco gets an existing RuleFalco resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetRuleFalco(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *RuleFalcoState, opts ...pulumi.ResourceOption) (*RuleFalco, error) {
	var resource RuleFalco
	err := ctx.ReadResource("sysdig:Secure/ruleFalco:RuleFalco", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering RuleFalco resources.
type ruleFalcoState struct {
	// This indicates that the rule being created appends the condition to an existing Sysdig-provided rule. By default this is false. Appending to user-created rules is not supported by the API.
	Append *bool `pulumi:"append"`
	// A [Falco condition](https://falco.org/docs/rules/) is simply a Boolean predicate on Sysdig events expressed using the Sysdig [filter syntax](http://www.sysdig.org/wiki/sysdig-user-guide/#filtering) and macro terms.
	Condition *string `pulumi:"condition"`
	// The description of Secure rule. By default is empty.
	Description *string `pulumi:"description"`
	// The exceptions key is a list of identifier plus list of tuples of filtercheck fields. See below for details.
	Exceptions []RuleFalcoException `pulumi:"exceptions"`
	// The name of the exception. Only used to provide a handy name, and to potentially link together values in a later rule that has `append = true`.
	Name *string `pulumi:"name"`
	// Add additional information to each Falco notification's output. Required if append is false.
	Output *string `pulumi:"output"`
	// The priority of the Falco rule. It can be: "emergency", "alert", "critical", "error", "warning", "notice", "info" or "debug". By default is "warning".
	Priority *string `pulumi:"priority"`
	// The source of the event. It can be either "syscall", "k8sAudit" or "awsCloudtrail". Required if append is false.
	Source *string `pulumi:"source"`
	// A list of tags for this rule.
	Tags []string `pulumi:"tags"`
	// Current version of the resource in Sysdig Secure.
	Version *int `pulumi:"version"`
}

type RuleFalcoState struct {
	// This indicates that the rule being created appends the condition to an existing Sysdig-provided rule. By default this is false. Appending to user-created rules is not supported by the API.
	Append pulumi.BoolPtrInput
	// A [Falco condition](https://falco.org/docs/rules/) is simply a Boolean predicate on Sysdig events expressed using the Sysdig [filter syntax](http://www.sysdig.org/wiki/sysdig-user-guide/#filtering) and macro terms.
	Condition pulumi.StringPtrInput
	// The description of Secure rule. By default is empty.
	Description pulumi.StringPtrInput
	// The exceptions key is a list of identifier plus list of tuples of filtercheck fields. See below for details.
	Exceptions RuleFalcoExceptionArrayInput
	// The name of the exception. Only used to provide a handy name, and to potentially link together values in a later rule that has `append = true`.
	Name pulumi.StringPtrInput
	// Add additional information to each Falco notification's output. Required if append is false.
	Output pulumi.StringPtrInput
	// The priority of the Falco rule. It can be: "emergency", "alert", "critical", "error", "warning", "notice", "info" or "debug". By default is "warning".
	Priority pulumi.StringPtrInput
	// The source of the event. It can be either "syscall", "k8sAudit" or "awsCloudtrail". Required if append is false.
	Source pulumi.StringPtrInput
	// A list of tags for this rule.
	Tags pulumi.StringArrayInput
	// Current version of the resource in Sysdig Secure.
	Version pulumi.IntPtrInput
}

func (RuleFalcoState) ElementType() reflect.Type {
	return reflect.TypeOf((*ruleFalcoState)(nil)).Elem()
}

type ruleFalcoArgs struct {
	// This indicates that the rule being created appends the condition to an existing Sysdig-provided rule. By default this is false. Appending to user-created rules is not supported by the API.
	Append *bool `pulumi:"append"`
	// A [Falco condition](https://falco.org/docs/rules/) is simply a Boolean predicate on Sysdig events expressed using the Sysdig [filter syntax](http://www.sysdig.org/wiki/sysdig-user-guide/#filtering) and macro terms.
	Condition string `pulumi:"condition"`
	// The description of Secure rule. By default is empty.
	Description *string `pulumi:"description"`
	// The exceptions key is a list of identifier plus list of tuples of filtercheck fields. See below for details.
	Exceptions []RuleFalcoException `pulumi:"exceptions"`
	// The name of the exception. Only used to provide a handy name, and to potentially link together values in a later rule that has `append = true`.
	Name *string `pulumi:"name"`
	// Add additional information to each Falco notification's output. Required if append is false.
	Output *string `pulumi:"output"`
	// The priority of the Falco rule. It can be: "emergency", "alert", "critical", "error", "warning", "notice", "info" or "debug". By default is "warning".
	Priority *string `pulumi:"priority"`
	// The source of the event. It can be either "syscall", "k8sAudit" or "awsCloudtrail". Required if append is false.
	Source *string `pulumi:"source"`
	// A list of tags for this rule.
	Tags []string `pulumi:"tags"`
}

// The set of arguments for constructing a RuleFalco resource.
type RuleFalcoArgs struct {
	// This indicates that the rule being created appends the condition to an existing Sysdig-provided rule. By default this is false. Appending to user-created rules is not supported by the API.
	Append pulumi.BoolPtrInput
	// A [Falco condition](https://falco.org/docs/rules/) is simply a Boolean predicate on Sysdig events expressed using the Sysdig [filter syntax](http://www.sysdig.org/wiki/sysdig-user-guide/#filtering) and macro terms.
	Condition pulumi.StringInput
	// The description of Secure rule. By default is empty.
	Description pulumi.StringPtrInput
	// The exceptions key is a list of identifier plus list of tuples of filtercheck fields. See below for details.
	Exceptions RuleFalcoExceptionArrayInput
	// The name of the exception. Only used to provide a handy name, and to potentially link together values in a later rule that has `append = true`.
	Name pulumi.StringPtrInput
	// Add additional information to each Falco notification's output. Required if append is false.
	Output pulumi.StringPtrInput
	// The priority of the Falco rule. It can be: "emergency", "alert", "critical", "error", "warning", "notice", "info" or "debug". By default is "warning".
	Priority pulumi.StringPtrInput
	// The source of the event. It can be either "syscall", "k8sAudit" or "awsCloudtrail". Required if append is false.
	Source pulumi.StringPtrInput
	// A list of tags for this rule.
	Tags pulumi.StringArrayInput
}

func (RuleFalcoArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*ruleFalcoArgs)(nil)).Elem()
}

type RuleFalcoInput interface {
	pulumi.Input

	ToRuleFalcoOutput() RuleFalcoOutput
	ToRuleFalcoOutputWithContext(ctx context.Context) RuleFalcoOutput
}

func (*RuleFalco) ElementType() reflect.Type {
	return reflect.TypeOf((*RuleFalco)(nil))
}

func (i *RuleFalco) ToRuleFalcoOutput() RuleFalcoOutput {
	return i.ToRuleFalcoOutputWithContext(context.Background())
}

func (i *RuleFalco) ToRuleFalcoOutputWithContext(ctx context.Context) RuleFalcoOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RuleFalcoOutput)
}

func (i *RuleFalco) ToRuleFalcoPtrOutput() RuleFalcoPtrOutput {
	return i.ToRuleFalcoPtrOutputWithContext(context.Background())
}

func (i *RuleFalco) ToRuleFalcoPtrOutputWithContext(ctx context.Context) RuleFalcoPtrOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RuleFalcoPtrOutput)
}

type RuleFalcoPtrInput interface {
	pulumi.Input

	ToRuleFalcoPtrOutput() RuleFalcoPtrOutput
	ToRuleFalcoPtrOutputWithContext(ctx context.Context) RuleFalcoPtrOutput
}

type ruleFalcoPtrType RuleFalcoArgs

func (*ruleFalcoPtrType) ElementType() reflect.Type {
	return reflect.TypeOf((**RuleFalco)(nil))
}

func (i *ruleFalcoPtrType) ToRuleFalcoPtrOutput() RuleFalcoPtrOutput {
	return i.ToRuleFalcoPtrOutputWithContext(context.Background())
}

func (i *ruleFalcoPtrType) ToRuleFalcoPtrOutputWithContext(ctx context.Context) RuleFalcoPtrOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RuleFalcoPtrOutput)
}

// RuleFalcoArrayInput is an input type that accepts RuleFalcoArray and RuleFalcoArrayOutput values.
// You can construct a concrete instance of `RuleFalcoArrayInput` via:
//
//          RuleFalcoArray{ RuleFalcoArgs{...} }
type RuleFalcoArrayInput interface {
	pulumi.Input

	ToRuleFalcoArrayOutput() RuleFalcoArrayOutput
	ToRuleFalcoArrayOutputWithContext(context.Context) RuleFalcoArrayOutput
}

type RuleFalcoArray []RuleFalcoInput

func (RuleFalcoArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*RuleFalco)(nil)).Elem()
}

func (i RuleFalcoArray) ToRuleFalcoArrayOutput() RuleFalcoArrayOutput {
	return i.ToRuleFalcoArrayOutputWithContext(context.Background())
}

func (i RuleFalcoArray) ToRuleFalcoArrayOutputWithContext(ctx context.Context) RuleFalcoArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RuleFalcoArrayOutput)
}

// RuleFalcoMapInput is an input type that accepts RuleFalcoMap and RuleFalcoMapOutput values.
// You can construct a concrete instance of `RuleFalcoMapInput` via:
//
//          RuleFalcoMap{ "key": RuleFalcoArgs{...} }
type RuleFalcoMapInput interface {
	pulumi.Input

	ToRuleFalcoMapOutput() RuleFalcoMapOutput
	ToRuleFalcoMapOutputWithContext(context.Context) RuleFalcoMapOutput
}

type RuleFalcoMap map[string]RuleFalcoInput

func (RuleFalcoMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*RuleFalco)(nil)).Elem()
}

func (i RuleFalcoMap) ToRuleFalcoMapOutput() RuleFalcoMapOutput {
	return i.ToRuleFalcoMapOutputWithContext(context.Background())
}

func (i RuleFalcoMap) ToRuleFalcoMapOutputWithContext(ctx context.Context) RuleFalcoMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(RuleFalcoMapOutput)
}

type RuleFalcoOutput struct{ *pulumi.OutputState }

func (RuleFalcoOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*RuleFalco)(nil))
}

func (o RuleFalcoOutput) ToRuleFalcoOutput() RuleFalcoOutput {
	return o
}

func (o RuleFalcoOutput) ToRuleFalcoOutputWithContext(ctx context.Context) RuleFalcoOutput {
	return o
}

func (o RuleFalcoOutput) ToRuleFalcoPtrOutput() RuleFalcoPtrOutput {
	return o.ToRuleFalcoPtrOutputWithContext(context.Background())
}

func (o RuleFalcoOutput) ToRuleFalcoPtrOutputWithContext(ctx context.Context) RuleFalcoPtrOutput {
	return o.ApplyTWithContext(ctx, func(_ context.Context, v RuleFalco) *RuleFalco {
		return &v
	}).(RuleFalcoPtrOutput)
}

type RuleFalcoPtrOutput struct{ *pulumi.OutputState }

func (RuleFalcoPtrOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**RuleFalco)(nil))
}

func (o RuleFalcoPtrOutput) ToRuleFalcoPtrOutput() RuleFalcoPtrOutput {
	return o
}

func (o RuleFalcoPtrOutput) ToRuleFalcoPtrOutputWithContext(ctx context.Context) RuleFalcoPtrOutput {
	return o
}

func (o RuleFalcoPtrOutput) Elem() RuleFalcoOutput {
	return o.ApplyT(func(v *RuleFalco) RuleFalco {
		if v != nil {
			return *v
		}
		var ret RuleFalco
		return ret
	}).(RuleFalcoOutput)
}

type RuleFalcoArrayOutput struct{ *pulumi.OutputState }

func (RuleFalcoArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]RuleFalco)(nil))
}

func (o RuleFalcoArrayOutput) ToRuleFalcoArrayOutput() RuleFalcoArrayOutput {
	return o
}

func (o RuleFalcoArrayOutput) ToRuleFalcoArrayOutputWithContext(ctx context.Context) RuleFalcoArrayOutput {
	return o
}

func (o RuleFalcoArrayOutput) Index(i pulumi.IntInput) RuleFalcoOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) RuleFalco {
		return vs[0].([]RuleFalco)[vs[1].(int)]
	}).(RuleFalcoOutput)
}

type RuleFalcoMapOutput struct{ *pulumi.OutputState }

func (RuleFalcoMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]RuleFalco)(nil))
}

func (o RuleFalcoMapOutput) ToRuleFalcoMapOutput() RuleFalcoMapOutput {
	return o
}

func (o RuleFalcoMapOutput) ToRuleFalcoMapOutputWithContext(ctx context.Context) RuleFalcoMapOutput {
	return o
}

func (o RuleFalcoMapOutput) MapIndex(k pulumi.StringInput) RuleFalcoOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) RuleFalco {
		return vs[0].(map[string]RuleFalco)[vs[1].(string)]
	}).(RuleFalcoOutput)
}

func init() {
	pulumi.RegisterOutputType(RuleFalcoOutput{})
	pulumi.RegisterOutputType(RuleFalcoPtrOutput{})
	pulumi.RegisterOutputType(RuleFalcoArrayOutput{})
	pulumi.RegisterOutputType(RuleFalcoMapOutput{})
}
